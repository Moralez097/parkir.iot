<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard Parkir Modern</title>

    <style>
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          Helvetica, Arial, sans-serif;
        background: #f3f4f6;
        padding: 20px;
        color: #1f2937;
      }

      h1 {
        margin-top: 50px;
        margin-bottom: 20px;
        font-size: 1.8rem;
        color: #111827;
      }

      .dashboard {
        max-width: 1300px;
        margin: auto;
      }

      .card {
        background: #ffffff;
        padding: 24px;
        border-radius: 12px;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        margin-bottom: 24px;
        overflow: hidden;
      }

      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
        gap: 20px;
        margin-bottom: 24px;
      }

      .stats-card {
        background: #ffffff;
        padding: 24px;
        border-radius: 12px;
        border: 1px solid #e5e7eb;
        display: flex;
        align-items: center;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      }

      .stats-card .value {
        font-size: 2.25rem;
        font-weight: 700;
        line-height: 1;
        margin-bottom: 4px;
      }

      .stats-card .label {
        font-size: 0.875rem;
        color: #6b7280;
        font-weight: 500;
      }

      .stats-card.terisi {
        border-left: 6px solid #ef4444;
      }

      .stats-card.terisi .value {
        color: #ef4444;
      }

      .stats-card.tersedia {
        border-left: 6px solid #22c55e;
      }

      .stats-card.tersedia .value {
        color: #22c55e;
      }

      .peta-container {
        display: grid;
        grid-template-columns: repeat(12, 1fr);
        gap: 15px;
        padding: 20px;
        background: #e5e7eb;
        border-radius: 12px;
        position: relative;
      }

      .denah-spot {
        height: 60px;
        background: #dcfce7;
        border: 2px solid #86efac;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        color: #166534;
        transition: all 0.3s ease;
        font-size: 0.9rem;
      }

      .spot-mobil {
        height: 80px;
        font-size: 1.1rem;
        border-width: 3px;
      }

      .denah-spot.terisi {
        background: #fee2e2;
        border-color: #fca5a5;
        color: #991b1b;
      }

      .jalan-h {
        grid-column: 1 / -1;
        height: 60px;
        background: repeating-linear-gradient(
          90deg,
          #374151 0 30px,
          #4b5563 30px 60px
        );
        border-radius: 8px;
        opacity: 0.8;
      }

      .jalan-v {
        grid-column: 7;
        grid-row: 1 / -1;
        width: 60px;
        background: repeating-linear-gradient(
          180deg,
          #374151 0 30px,
          #4b5563 30px 60px
        );
        border-radius: 8px;
        justify-self: center;
        height: 100%;
        opacity: 0.8;
      }

      .jalan-vb {
        grid-column: 7;
        grid-row: 3 / 5;
        width: 60px;
        background: repeating-linear-gradient(
          180deg,
          #374151 0 30px,
          #4b5563 30px 60px
        );
        border-radius: 8px;
        justify-self: center;
        height: 100%;
        opacity: 0.8;
      }

      .blok {
        display: grid;
        grid-template-columns: repeat(6, 1fr);
        gap: 8px;
      }

      .blok-mobil {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
        gap: 8px;
      }

      @media (max-width: 1024px) {
        .peta-container {
          display: flex;
          flex-direction: column;
          gap: 20px;
        }

        .jalan-v,
        .jalan-vb {
          display: none;
        }

        .blok {
          grid-column: auto !important;

          grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
        }

        .blok-mobil {
          grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
        }

        .jalan-h {
          height: 40px;
          background-size: 40px 40px;
        }
      }

      @media (max-width: 640px) {
        body {
          padding: 10px;
        }

        .stats-grid {
          grid-template-columns: 1fr;
        }

        .blok {
          grid-template-columns: repeat(4, 1fr);
          gap: 8px;
        }

        .blok-mobil {
          grid-template-columns: repeat(auto-fit, minmax(110px, 1fr));
          gap: 10px;
        }

        .jalan-h,
        .jalan-v,
        .jalan-vb {
          display: none !important;
        }

        .denah-spot {
          height: 50px;
          font-size: 0.8rem;
        }

        .spot-mobil {
          height: 70px;
          font-size: 1rem;
        }
      }
    </style>
  </head>

  <body>
    <div class="dashboard">
      <h1>Peta Parkiran</h1>

      <section class="stats-grid">
        <div class="stats-card terisi">
          <div>
            <div class="value" id="stats-terisi">0</div>
            <div class="label">Slot Terisi</div>
          </div>
        </div>

        <div class="stats-card tersedia">
          <div>
            <div class="value" id="stats-tersedia">0</div>
            <div class="label">Slot Tersedia</div>
          </div>
        </div>
      </section>

      <section class="card">
        <div class="peta-container">
          <div class="blok" style="grid-column: 1 / span 6">
            <div class="denah-spot" data-slot="m1">M1</div>
            <div class="denah-spot" data-slot="m2">M2</div>
            <div class="denah-spot" data-slot="m3">M3</div>
            <div class="denah-spot" data-slot="m4">M4</div>
            <div class="denah-spot" data-slot="m5">M5</div>
            <div class="denah-spot" data-slot="m6">M6</div>
            <div class="denah-spot" data-slot="m7">M7</div>
            <div class="denah-spot" data-slot="m8">M8</div>
            <div class="denah-spot" data-slot="m9">M9</div>
            <div class="denah-spot" data-slot="m10">M10</div>
            <div class="denah-spot" data-slot="m11">M11</div>
            <div class="denah-spot" data-slot="m12">M12</div>
          </div>

          <div class="jalan-v"></div>

          <div class="blok" style="grid-column: 8 / span 5">
            <div class="denah-spot" data-slot="m13">M13</div>
            <div class="denah-spot" data-slot="m14">M14</div>
            <div class="denah-spot" data-slot="m15">M15</div>
            <div class="denah-spot" data-slot="m16">M16</div>
            <div class="denah-spot" data-slot="m17">M17</div>
            <div class="denah-spot" data-slot="m18">M18</div>
            <div class="denah-spot" data-slot="m19">M19</div>
            <div class="denah-spot" data-slot="m20">M20</div>
            <div class="denah-spot" data-slot="m21">M21</div>
            <div class="denah-spot" data-slot="m22">M22</div>
            <div class="denah-spot" data-slot="m23">M23</div>
            <div class="denah-spot" data-slot="m24">M24</div>
          </div>

          <div class="jalan-h"></div>

          <div class="blok" style="grid-column: 1 / span 6">
            <div class="denah-spot" data-slot="m25">M25</div>
            <div class="denah-spot" data-slot="m26">M26</div>
            <div class="denah-spot" data-slot="m27">M27</div>
            <div class="denah-spot" data-slot="m28">M28</div>
            <div class="denah-spot" data-slot="m29">M29</div>
            <div class="denah-spot" data-slot="m30">M30</div>
            <div class="denah-spot" data-slot="m31">M31</div>
            <div class="denah-spot" data-slot="m32">M32</div>
            <div class="denah-spot" data-slot="m33">M33</div>
            <div class="denah-spot" data-slot="m34">M34</div>
            <div class="denah-spot" data-slot="m35">M35</div>
            <div class="denah-spot" data-slot="m36">M36</div>
          </div>

          <div class="jalan-vb"></div>

          <div class="blok" style="grid-column: 8 / span 5">
            <div class="denah-spot" data-slot="m37">M37</div>
            <div class="denah-spot" data-slot="m38">M38</div>
            <div class="denah-spot" data-slot="m39">M39</div>
            <div class="denah-spot" data-slot="m40">M40</div>
            <div class="denah-spot" data-slot="m41">M41</div>
            <div class="denah-spot" data-slot="m42">M42</div>
            <div class="denah-spot" data-slot="m43">M43</div>
            <div class="denah-spot" data-slot="m44">M44</div>
            <div class="denah-spot" data-slot="m45">M45</div>
            <div class="denah-spot" data-slot="m46">M46</div>
            <div class="denah-spot" data-slot="m47">M47</div>
            <div class="denah-spot" data-slot="m48">M48</div>
          </div>

          <div class="jalan-h"></div>

          <div class="blok-mobil" style="grid-column: span 12">
            <div class="denah-spot spot-mobil" data-slot="c1">C1</div>
            <div class="denah-spot spot-mobil" data-slot="c2">C2</div>
            <div class="denah-spot spot-mobil" data-slot="c3">C3</div>
            <div class="denah-spot spot-mobil" data-slot="c4">C4</div>
            <div class="denah-spot spot-mobil" data-slot="c5">C5</div>
            <div class="denah-spot spot-mobil" data-slot="c6">C6</div>
            <div class="denah-spot spot-mobil" data-slot="c7">C7</div>
            <div class="denah-spot spot-mobil" data-slot="c8">C8</div>
            <div class="denah-spot spot-mobil" data-slot="c9">C9</div>
            <div class="denah-spot spot-mobil" data-slot="c10">C10</div>
          </div>
        </div>
      </section>
    </div>

    <script>
      function updateStats(data) {
        const terisi = data.filter((i) => i.status == 1).length;
        const tersedia = data.filter((i) => i.status == 0).length;

        document.getElementById("stats-terisi").textContent = terisi;
        document.getElementById("stats-tersedia").textContent = tersedia;
      }

      async function loadParkiran() {
        const spots = document.querySelectorAll(".denah-spot");

        try {
          const res = await fetch(
            "https://everlasting.pythonanywhere.com/parkiran"
          );
          const data = await res.json();

          updateStats(data);

          spots.forEach((spot) => {
            const slot = spot.dataset.slot;

            const s = data.find(
              (i) => i.slot.toLowerCase() == slot.toLowerCase()
            );

            if (!s) return;

            spot.classList.remove("terisi");

            if (Number(s.status) === 1) {
              spot.classList.add("terisi");
            }
          });
        } catch (err) {
          console.error("Gagal load:", err);
        }
      }

      setInterval(loadParkiran, 2000);
      loadParkiran();
    </script>
  </body>
</html>
